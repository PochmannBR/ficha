<html lang="pt-BR">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="author" content="PochmannBR">
    <title>Ficha Catalográfica</title>
    
    <link rel="stylesheet" href="./Ficha Catalográfica_files/bootstrap.min.css">
    <link rel="stylesheet" href="./Ficha Catalográfica_files/Contact-Form-Clean.css">
    <link rel="stylesheet" href="./Ficha Catalográfica_files/bootstrap-icons.css">
    <script src="./Ficha Catalográfica_files/jquery.min.js.download"></script>
    
    <style>
        .hidden { display: none; opacity: 0; }
        .visible { display: block; animation: fadeIn 0.5s ease-in forwards; }
        @keyframes fadeIn { 0% { opacity: 0; } 100% { opacity: 1; } }
        .title { text-align: right; text-transform: uppercase; color: red; font-weight: bold; font-family: "Baloo 2", cursive; }
        .title2 { text-align: right; font-size: 45px; padding-top: 40px; text-transform: uppercase; color: #ffffff; font-family: "Baloo 2", cursive; }
        .modalBtn { text-align: right; text-transform: uppercase; color: red; font-weight: bold; font-family: "Baloo 2", cursive; }
        input[type="radio"] { gap: 5px; }
        .text { margin-top: 0; font-size: 1.1em; color: rgb(255, 255, 255); }
        .aviso { margin-top: 0; font-size: 1.1em; color: #000; font-size: 17px; }
        .modal { position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.493); scrollbar-width: none; }
        .modal .content { background: rgba(255, 255, 255, 0.07); border-radius: 16px; box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); backdrop-filter: blur(9.8px); -webkit-backdrop-filter: blur(9.8px); border: 1px solid rgba(255, 255, 255, 0.19); margin: 15% auto; padding: 20px; border-radius: 15px; width: 45%; color: #ffffff; display: flex; flex-direction: column; align-items: center; font-family: "Baloo 2", cursive; color: var(--title); }
    </style>
</head>
  
<body>
    <div class="contact-clean">
      <section id="modalBox">
        <div class="modal hidden">
          <div class="content">
            <h1 class="title2">Instruções de uso</h1>
            <p class="aviso">Você pode fechar esta janela clicando fora desta área.</p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span style="width: 35.4pt; display: inline-block">&nbsp;</span>
              <span>
                A ficha catalográfica é um conjunto ordenado de dados que traz a
                descrição física e temática de uma obra. É um elemento
                obrigatório em todas as publicações monográficas, conforme
                estabelecido pela Lei Federal 10.753/03, também conhecida como a
                Lei do Livro, e tem os padrões regulados pela norma técnica NBR
                14724. Deve ser disposta no verso da folha de rosto,
                centralizada, na parte inferior da folha e ter o tamanho padrão
                de 7,5cm x 12,5 cm.
              </span>
            </p>
            <p class="text" style="
                margin-top: 0pt;
                margin-bottom: 8pt;
                text-indent: 35.4pt;
                line-height: 108%;
              ">
              <span>
                O Sistema de Geração de Ficha Catalográfica da Escola de
                Aperfeiçoamento de Oficiais está programado para atender aos
                trabalhos de todo o corpo discente da escola. Ele produz uma
                ficha a partir do preenchimento deste formulário&nbsp;</span>
              <em>
                <span>on-line</span>
              </em>
              <span>.&nbsp;</span>
            </p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span style="width: 35.4pt; display: inline-block">&nbsp;</span>
              <span>
                Os dados serão apresentados na ficha conforme informados pelo
                usuário. Caso você tenha alguma dúvida, consulte a Biblioteca da
                EsAO.</span>
            </p>

            <ol style="margin: 0pt; padding-left: 0pt" type="1">
              <li class="text" style="margin-left: 32pt; line-height: 108%; padding-left: 4pt">
                <strong>Autor:</strong> é o responsável direto pela geração
                intelectual e redação da obra. (TCC/Dissertação) A entrada desse
                dado no formulário é feita em dois campos:
              </li>
            </ol>
            <ul style="margin: 0pt; padding-left: 0pt" type="disc">
              <li class="text" style="
                  margin-left: 68.43pt;
                  line-height: 108%;
                  padding-left: 3.57pt;
                  font-family: serif;
                ">
                <strong>
                  <span>✓ NOME:&nbsp;</span>
                </strong>
                <span>digite seu primeiro nome e nomes/sobrenomes intermediários
                  (se existirem)</span>
              </li>
              <li class="text" style="
                  margin-left: 68.43pt;
                  margin-bottom: 8pt;
                  line-height: 108%;
                  padding-left: 3.57pt;
                  font-family: serif;
                ">
                <strong> <span>✓ SOBRENOME:</span> </strong>
                <span>&nbsp;digite seu último sobrenome de acordo com os exemplos
                  abaixo.</span>
              </li>
            </ul>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span>Exemplos de sobrenome simples: Luís Alves de Lima e Silva (Luís
                Alves de Lima e = nome; Silva = sobrenome)</span>
            </p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span>Grau de Parentesco: Ex. 1 - Manuel Luís Osório Júnior (Manuel
                Luís = nome; Osório Júnior = sobrenome) Ex. 2 - Manuel Luís
                Osório Filho (Manuel Luís = nome; Osório Filho = sobrenome) Ex.
                3 - Manuel Luís Osório Neto (Manuel Luís = nome; Osório Neto =
                sobrenome)</span>
            </p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span>Lugar, expressão: Emílio Mallet do Espírito Santo (Emílio
                Mallet do = nome; Espírito Santo = sobrenome). Humberto de
                Alencar Castello Branco (Humberto de Alencar = nome; Castello
                Branco = sobrenome)</span>
            </p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span>Sobrenome ligados por hífen: Anna Guerra-Peixe (Anna = nome;
                Guerra-Peixe = sobrenome)</span>
            </p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span>Sobrenome para sobrenome estrangeiro (países hispânicos):</span>
            </p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span>María de la Concepción Gutierrez Peñalba (Maria de la
                Concepción = nome; Gutierrez Peñalba = sobrenome)</span>
            </p>
            <p class="text" style="margin-top: 0pt; margin-bottom: 8pt; line-height: 108%">
              <span>&nbsp;</span>
            </p>
            <ol start="2" style="margin: 0pt; padding-left: 0pt" type="1">
              <li class="text" style="margin-left: 32pt; line-height: 108%; padding-left: 4pt">
                <strong>Título do trabalho: </strong>registre-o por completo. Se
                houver um subtítulo, este deverá ser colocado no campo
                subtítulo, onde após gerar a ficha o mesmo será separado do
                título pelo sinal de dois pontos. Utilize letras somente no
                início do título ou quando tratar-se de nome próprio ou siglas.
              </li>
            </ol>
            <p class="text" style="
                margin-top: 0pt;
                margin-left: 36pt;
                margin-bottom: 0pt;
                line-height: 108%;
              ">
              <span>Exemplo: A vida de Luís Alves de Lima e Silva: um estudo sobre
                os feitos do Duque de Caxias no Rio de Janeiro.</span>
            </p>
            <p class="text" style="
                margin-top: 0pt;
                margin-left: 36pt;
                margin-bottom: 0pt;
                line-height: 108%;
              ">
              <span>&nbsp;</span>
            </p>
            <p class="text" style="
                margin-top: 0pt;
                margin-left: 36pt;
                margin-bottom: 0pt;
                line-height: 108%;
              ">
              <span>&nbsp;</span>
            </p>

            <li class="text" style="margin-left: 32pt; line-height: 108%; padding-left: 4pt">
              <strong>Nome completo do orientador:</strong> digite o nome
              completo do seu orientador;
            </li>
            <li class="text" style="margin-left: 32pt; line-height: 108%; padding-left: 4pt">
              <strong>Quantidade de folhas, páginas ou volumes:</strong>
              digite a quantidade de folhas que seu trabalho possui, não conte
              capa.
            </li>
            <li class="text" style="margin-left: 32pt; line-height: 108%; padding-left: 4pt">
              <strong>Ilustração: </strong>informe se o seu trabalho possui
              ilustrações, caso positivo informe se são coloridas ou preto e
              branco;
            </li>
            <li class="text" style="margin-left: 32pt; line-height: 108%; padding-left: 4pt">
              <strong>Palavras chave:</strong> Digite as palavras chave
              correspondente ao seu trabalho, com o mínimo de 3 e o máximo de 5
              palavras. Registre palavras ou expressões que representem o
              conteúdo do seu trabalho, em ordem decrescente de importância (do
              mais importante para o menos importante). Use palavras-chave
              localizadas após o resumo do trabalho.
            </li>
            <li class="text" style="
                margin-left: 32pt;
                margin-bottom: 8pt;
                line-height: 108%;
                padding-left: 4pt;
              ">
              <strong>Conclusão:</strong> após o preenchimento de todos os
              campos a ficha será gerada no formato <em> .PDF</em> e estará
              disponível em uma outra aba do seu navegador para donwloading ou
              impressão.
            </li>
          </div>
        </div>
      </section>

      <form id="meuform">
        <input type="" hidden="" name="cutter" id="cutter" value="">
        <p class="modalBtn">
          <i class="bi bi-info-circle"></i>
          <a style="cursor: pointer">Clique aqui para instruções de uso deste gerador</a>
        </p>

        <div class="form-group">
          <legend><span class="number">1</span> Dados Pessoais</legend>
          <div class="form-group flex-column"></div>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">Nome completo</span>
            </div>
            <input type="text" class="form-control" id="name" name="name" placeholder="Nome" required="">
            <input type="text" class="form-control" id="sname" name="sname" placeholder="Último nome" required="">
          </div>
          <div class="form-group flex-column"></div>
          <legend><span class="number">2</span> Dados do trabalho</legend>
          <div class="form-group flex-column"></div>
          <div class="row">
            <div class="col">
              <input type="text" class="form-control" placeholder="Título do trabalho" id="ttrabalho" name="ttrabalho" required="">
            </div>
            <div class="col">
              <input type="text" class="form-control" style="text-transform: lowercase" placeholder="Subtítulo do trabalho" id="strabalho" name="strabalho">
            </div>
          </div>
          <div class="form-group flex-column"></div>
          <div class="form-group flex-column"></div>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">Nome do orientador&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
            </div>
            <input type="text" class="form-control" id="orientador" name="orientador" required="">

            <span class="input-group-text">
              <input type="radio" id="tccInput" name="tcc" value="&nbsp;&nbsp;&nbsp;Trabalho de Conclusão de Curso - Escola de Aperfeiçoamento de Oficiais - EsAO, Rio de Janeiro,">TCC
              <input type="radio" name="mestrado" value="&nbsp;&nbsp;&nbsp;Dissertação (Mestre em Ciências Militares) - Escola de Aperfeiçoamento de Oficiais - EsAO, Rio de Janeiro,">
              Mestrado
            </span>
          </div>

          <div class="form-group flex-column"></div>
          <div class="form-group flex-column"></div>
          <div class="form-group flex-column"></div>
          <div class="row">
            <div class="col">
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                  <label class="input-group-text" for="inputGroupSelect01">Ano de publicação</label>
                </div>
                <select class="custom-select" id="inputGroupSelect01" name="ano" required="">
                  <option value="2025">2025</option>
                  <option value="2026">2026</option>
                  <option value="2027">2027</option>
                  <option value="2028">2028</option>
                  <option value="2029">2029</option>
                  <option value="2030">2030</option>
                  <option value="2031">2031</option>
                  <option value="2032">2032</option>
                </select>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text" id="">Número de folhas &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                </div>
                <input type="number" pattern="[0-9]*" class="form-control" placeholder="Ex.: 70" id="nfolha" name="nfolha" min="1" required="">
              </div>
            </div>
            <div class="col">
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                  <label class="input-group-text" for="inputGroupSelect02">Ilustração</label>
                </div>
                <select class="custom-select" id="inputGroupSelect02" name="ilustracao" required="">
                  <option selected="">Selecione</option>
                  <option value=".">Não possui</option>
                  <option value=". il. color.">Coloridas</option>
                  <option value=". il.">Preto e Branco</option>
                </select>
              </div>
            </div>
          </div>
          <div class="form-group flex-column"></div>
          <legend><span class="number">3</span> Palavras-chave</legend>
          <div class="form-group flex-column"></div>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" id="">Assuntos (mín. 1, máx. 5)</span>
            </div>
            <input type="text" class="form-control" placeholder="(Ex.: Infantaria)" id="keyd1" name="keyd1" required="">
            <input type="text" class="form-control" placeholder="(Ex.: Cavalaria)" id="keyd2" name="keyd2">
            <input type="text" class="form-control" placeholder="(Ex.: Amazônia)" id="keyd3" name="keyd3">
          </div>
          <div class="form-group flex-column"></div>
          <div class="input-group">
            <input type="text" class="form-control" placeholder="(Ex.: Veículos de Combate)" id="keyd4" name="keyd4">
            <input type="text" class="form-control" placeholder="(Ex.: Exército Brasileiro)" id="keyd5" name="keyd5">
          </div>
          <div class="form-group flex-column"></div>
        </div>
        <div class="form-group">
          <button id="btn_submit" class="btn btn-primary btn-lg btn-block" type="submit" style="text-align: center" name="submit">
            Gerar ficha catalográfica
          </button>
        </div>
        <br>
        <center style="color: #c2c2c2">
          Desenvolvido por: <a style="text-align: center; color: #c2c2c2" href="https://allvz.com.br/" target="_blank">
           <strong>Sd Bruno</strong> Ferreira <strong>Alves</strong></a>
          e
          <a style="text-align: center; color: #c2c2c2" href="https://github.com/Frevoleo" target="_blank"><strong>Sd</strong> Flávio Leonel <strong>Marynowski</strong></a>
          <p>
          Adaptado para uso na Internet por: <a style="text-align: center; color: #c2c2c2" href="https://www.linkedin.com/in/pablo-pochmann/" target="_blank"><strong>Maj</strong> Pablo Gustavo Cogo <strong>Pochmann</strong></a>
        </center>
      </form>
    </div>

    <script src="./Ficha Catalográfica_files/cutter.js.download"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

  <script>
    // ESTA LINHA ABAIXO É A CURA PARA O ERRO 1 (DOM carregado)
    document.addEventListener("DOMContentLoaded", function() {

        // --- Correção de Fontes do PDFMake ---
        if (typeof pdfMake !== 'undefined' && pdfMake.vfs) {
           pdfMake.vfs = pdfMake.vfs;
        }

        const tccInput = document.getElementById("tccInput");
        
        // Verificação de segurança: Se o elemento não existir, para o script para não dar erro
        if (!tccInput) {
            console.error("Erro: Formulário não encontrado. Verifique se o HTML carregou corretamente.");
            return;
        }

        const mestradoInput = document.querySelector('input[name="mestrado"]');

        tccInput.addEventListener("change", () => {
          if (tccInput.checked) mestradoInput.checked = false;
        });

        mestradoInput.addEventListener("change", () => {
          if (mestradoInput.checked) tccInput.checked = false;
        });

        const modal = document.querySelector(".modal");
        const switchModal = () => {
          if (modal.classList.contains("hidden")) {
            modal.classList.remove("hidden");
            modal.classList.add("visible");
          } else {
            modal.classList.remove("visible");
            modal.classList.add("hidden");
          }
        };

        const btn = document.querySelector(".modalBtn");
        if(btn) btn.addEventListener("click", switchModal);

        window.onclick = function (event) {
          if (event.target == modal) {
            switchModal();
          }
        };

        // --- GERAÇÃO DO PDF ---
        const form = document.getElementById('meuform');
        if (form) {
            form.addEventListener('submit', function(e) {
                e.preventDefault(); 

                const name = document.getElementById('name').value.trim();
                const sname = document.getElementById('sname').value.trim();
                const title = document.getElementById('ttrabalho').value.trim();
                const subtitle = document.getElementById('strabalho').value.trim();
                const orientador = document.getElementById('orientador').value.trim();
                const ano = document.getElementById('inputGroupSelect01').value;
                const pages = document.getElementById('nfolha').value;
                const illSelect = document.getElementById('inputGroupSelect02');
                const illText = illSelect.options[illSelect.selectedIndex].value;
                
                // --- LÓGICA DO CUTTER (Híbrida: Tenta buscar, se falhar, calcula) ---
                let baseCutter = document.getElementById('cutter').value;

                // Tenta usar a função do cutter.js se disponível
                if (!baseCutter && typeof cutterFunc === 'function' && typeof table !== 'undefined') {
                    try {
                        cutterFunc(sname); 
                        baseCutter = document.getElementById('cutter').value;
                    } catch (err) {
                        console.warn("Erro ao executar cutterFunc externo:", err);
                    }
                }

                // Fallback Seguro (Matemático e Consistente)
                if (!baseCutter) {
                    console.warn("Gerando Cutter matemático de segurança.");
                    const cleanSname = sname.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase();
                    let somaLetras = 0;
                    for (let i = 0; i < cleanSname.length; i++) {
                        somaLetras += cleanSname.charCodeAt(i);
                    }
                    let numeroGerado = (somaLetras % 899) + 100;
                    baseCutter = sname.charAt(0).toUpperCase() + numeroGerado;
                }

                const letraTitulo = title.charAt(0).toLowerCase();
                let cutterFinal = baseCutter + letraTitulo;

                // Validação Tipo de Trabalho
                let tipoTrabalhoTexto = "";
                if (tccInput.checked) {
                    tipoTrabalhoTexto = tccInput.value;
                } else if (mestradoInput.checked) {
                    tipoTrabalhoTexto = mestradoInput.value;
                } else {
                    alert("Selecione TCC ou Mestrado");
                    return;
                }

                const keys = [];
                for(let i=1; i<=5; i++) {
                    let k = document.getElementById('keyd'+i).value.trim();
                    if(k) keys.push(k);
                }

                const authorLine = `${sname}, ${name}.`;
                let fullTitle = title;
                if(subtitle) fullTitle += `: ${subtitle}`;
                const quatroEspacos = "\u00A0\u00A0\u00A0\u00A0";
                const titleLine = `${quatroEspacos}${fullTitle} / ${name} ${sname}. - ${ano}.`;
                let illDesc = (illText === '.' || illText === 'Selecione') ? '' : ` : ${illText.replace(/^\.\s*/, '')}`; 
                const physDesc = `${quatroEspacos}${pages} f.${illDesc}`;
                const noteDesc = `${quatroEspacos}${tipoTrabalhoTexto} ${ano}.`;
                const advDesc = `Orientador: ${quatroEspacos}${orientador}.`;
                
                let keywordsText = "";
                keys.forEach((key, index) => {
                    keywordsText += `${quatroEspacos}${index + 1}. ${key}. `;
                });
                keywordsText += `I. Escola de Aperfeiçoamento de Oficiais. II. Título.`;

                var docDefinition = {
                    pageSize: 'A4',
                    pageMargins: [70, 90, 90, 70],
                    content: [
                        { text: '©' + ano, alignment: 'left', fontSize: 12 },
                        { text: 'ESCOLA DE APERFEIÇOAMENTO DE OFICIAIS', alignment: 'left', fontSize: 12 },
                        { text: 'Avenida Duque de Caxias, 2071 – Deodoro', alignment: 'left', fontSize: 12 },
                        { text: 'Rio de Janeiro – RJ CEP: 21615-220', alignment: 'left', fontSize: 12, margin: [0, 0, 0, 25] },
                        
                        { text: 'Este exemplar é de propriedade da Escola de Aperfeiçoamento de Oficiais, que poderá incluí-lo em base de dados, armazenar em computador ou adotar qualquer forma de arquivamento.', style: 'textoLegal' },
                        { text: 'É permitida a menção, reprodução parcial ou integral e a transmissão entre bibliotecas deste trabalho, sem modificação de seu texto, em qualquer meio que esteja ou venha a ser fixado, para pesquisa acadêmica, comentários e citações, desde que sem finalidade comercial e que seja feita a referência bibliográfica completa.', style: 'textoLegal' },
                        { text: 'Os conceitos expressos neste trabalho são de responsabilidade do(s) autor(es) e do(s) orientador(es) que declaram, para os devidos fins e sob as penas da lei, que a pesquisa constante neste trabalho foi por eles elaborada e que as informações necessárias foram objeto de consulta em literatura e outras fontes devidamente referenciadas, não efetuando plágio, fato comprovado pela utilização de programas anti-plágio. Declaram, ainda, que este trabalho, ou parte dele, não foi apresentado anteriormente para obtenção de qualquer outro grau acadêmico, estando cientes de que a inveracidade da presente declaração poderá resultar na anulação da titulação pela EsAO, entre outras consequências legais.', style: 'textoLegal', margin: [0, 0, 0, 200] },

                        // Ficha Centralizada com 3 colunas
                        {
                            columns: [
                                { width: '*', text: '' },
                                {
                                    width: 'auto',
                                    table: {
                                        widths: [350],
                                        body: [
                                            [{
                                                margin: [10, 10, 10, 10],
                                                columns: [
                                                    { width: 50, text: cutterFinal, alignment: 'center', margin: [0, 2, 0, 0] },
                                                    {
                                                        width: '*',
                                                        stack: [
                                                            { text: authorLine, margin: [0, 0, 0, 2] },
                                                            { text: titleLine, margin: [0, 0, 0, 2] },
                                                            { text: physDesc, margin: [0, 0, 0, 10] },
                                                            { text: noteDesc, margin: [0, 0, 0, 2] },
                                                            { text: advDesc, margin: [0, 0, 0, 10] },
                                                            { text: keywordsText, margin: [0, 0, 0, 10] },
                                                            { text: 'CDD 355', alignment: 'right' }
                                                        ],
                                                        alignment: 'right',
                                                        fontSize: 10
                                                    }
                                                ]
                                            }]
                                        ]
                                    },
                                    layout: {
                                        hLineWidth: function (i, node) { return 1; },
                                        vLineWidth: function (i, node) { return 1; },
                                        hLineColor: function (i, node) { return 'black'; },
                                        vLineColor: function (i, node) { return 'black'; },
                                    }
                                },
                                { width: '*', text: '' }
                            ]
                        }
                    ],
                    defaultStyle: { font: 'Roboto', fontSize: 10 },
                    styles: { textoLegal: { alignment: 'justify', fontSize: 10, margin: [0, 0, 0, 15], lineHeight: 1.1 } }
                };

                // MUDANÇA CRÍTICA AQUI: USAR .download() EM VEZ DE .open()
                // 1. Cria um nome de arquivo limpo (Ex: SILVA_Joao_Ficha.pdf)
                // Removemos acentos e espaços para garantir que baixe em qualquer computador/celular
                const nomeLimpo = name.normalize("NFD").replace(/[\u0300-\u036f]/g, "").replace(/\s/g, "_");
                const sobrenomeLimpo = sname.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase().replace(/\s/g, "_");

                const nomeArquivo = `${sobrenomeLimpo}_${nomeLimpo}_Ficha_Catalografica.pdf`;

                // 2. Baixa o arquivo com o nome dinâmico
                try {
                    pdfMake.createPdf(docDefinition).download(nomeArquivo);
                } catch (err) {
                    alert("Erro ao baixar. Verifique bloqueador de popups.");
                    console.error(err);
                }
            });
        }
    });
  </script>

</body>
</html>
